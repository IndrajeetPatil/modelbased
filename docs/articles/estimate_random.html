<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>How to use Mixed models to Estimate Individuals' Scores • modelbased</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="How to use Mixed models to Estimate Individuals' Scores" />
<meta property="og:description" content="modelbased" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modelbased</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/visualisation_matrix.html">Data grids</a>
    </li>
    <li>
      <a href="../articles/estimate_means.html">Marginal means</a>
    </li>
    <li>
      <a href="../articles/estimate_contrasts.html">Contrast analysis</a>
    </li>
    <li>
      <a href="../articles/estimate_response.html">Use a model to make predictions</a>
    </li>
    <li>
      <a href="../articles/describe_nonlinear.html">Describe non-linear curves</a>
    </li>
    <li>
      <a href="../articles/estimate_random.html">Estimate and Re-use Random Effects</a>
    </li>
    <li>
      <a href="../articles/modelisation_approach.html">The modelisation approach</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/easystats/modelbased/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<script src="estimate_random_files/header-attrs-2.7/header-attrs.js"></script>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use Mixed models to Estimate Individuals’ Scores</h1>
            
      
      <small class="dont-index">Source: <a href='https://github.com/easystats/modelbased/blob/master/vignettes/estimate_random.Rmd'><code>vignettes/estimate_random.Rmd</code></a></small>
      <div class="hidden name"><code>estimate_random.Rmd</code></div>

    </div>

    
    
<p>Mixed models are powerful tools that can be used for a variety of interesting purposes. Indeed, while they are typically used to be more accurate and resilient in estimating population-level effects (aka the “fixed” effects), they can also be used to gain insight into group-level (i.e., individuals’ level scores, if the random factors are individuals) variability.</p>
<p>For this practical walkthrough, we will use the <strong>Speed-Accuracy Data</strong> (Wagenmakers, Ratcliff, Gomez, &amp; McKoon, 2008) from the <code>rtdists</code> package, in which <strong>17 participants</strong> (the <strong>id</strong> variable) performed some reaction time (RT) experiment under two conditions, speed and accuracy (the <strong>condition</strong> variable).</p>
<p>How hypotheses is that participants will be <strong>faster</strong> (i.e., lower RT) in the speed condition as compared to the accuracy condition. On the other hand, they will make less <strong>errors</strong> in the accuracy condition as compared to the speed condition.</p>
<p>In the following, we will load the necessary packages and clean the data by removing outliers and out-of-scope data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># easystats packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(correlation)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># other packages </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rtdists)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> rtdists<span class="sc">::</span>speed_acc <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove outliers &amp;  Keep only word condition </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&lt;</span> <span class="fl">1.5</span>,  </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>         stim_cat <span class="sc">==</span> <span class="st">&quot;word&quot;</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>         frequency <span class="sc">==</span> <span class="st">&quot;low&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add new &#39;error&#39; column that is 1 if the response doesn&#39;t match the category</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(response) <span class="sc">!=</span> <span class="fu">as.character</span>(stim_cat), <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div id="speed-rt" class="section level1">
<h1>Speed (RT)</h1>
<div id="population-level-effects" class="section level2">
<h2>Population-level Effects</h2>
<p>For the reaction time, we will start by removing all the incorrect responses, since they are not reflective of a “successful” cognitive process. Then, and we will then plot the RT according to the condition and stimulus category.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_rt <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, error <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_rt, <span class="fu">aes</span>(<span class="at">y =</span> rt, condition)) <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="D:/Dropbox/RECHERCHE/N/easystats/modelbased/docs/articles/estimate_random_files/figure-html/unnamed-chunk-3-1.png" width="3281.25" /></p>
<p>The descriptive visualisation indeed seems to suggest that people are slower in the <strong>accuracy</strong> condition as compared to the <strong>speed</strong> condition. And there could also be a slight effect of <strong>frequency</strong>.</p>
<p>Let’s verify that using the <a href="https://easystats.github.io/modelbased/articles/modelisation_approach.html"><strong>modelisation approach</strong></a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rt <span class="sc">~</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">|</span> id) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> stim), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> data_rt)</span></code></pre></div>
<p>Let’s unpack the formula of this model. We’re tying to predict <code>rt</code> using different terms. These can be separated into two groups, the <em>fixed</em> effects and the <em>random</em> effects. Having <code>condition</code> as a fixed effect means that we are interested in estimating the <strong>“general”</strong> effect of the condition, across all subjects and items (i.e., at the <strong><em>population level</em></strong>). On top of that effect of condition, a second ‘fixed’ parameter was implicitly specified and will be estimated, the <strong>intercept</strong> (as you might know, one has to explicitly remove it through <code>rt ~ 0 + condition</code>, otherwise it is added automatically).</p>
<p>Let’s investigate these two fixed parameters first:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(model_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>)</span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter         | Coefficient |   SE |         95% CI | t(4506) |      p
&gt; --------------------------------------------------------------------------
&gt; (Intercept)       |        0.69 | 0.02 | [ 0.65,  0.74] |   30.44 | &lt; .001
&gt; condition [speed] |       -0.16 | 0.02 | [-0.19, -0.12] |   -8.53 | &lt; .001</code></pre>
<p>Because <code>condition</code> is a factor with two levels, these parameters are easily interpretable. The <em>intercept</em> corresponds to the <code>rt</code> at the baseline level of the factor (accuracy), and the effect of condition corresponds to the change in <code>rt</code> between the intercept and the speed condition. In other words, the effect of <code>condition</code> refers to the difference between the two conditions, <code>speed - accuracy</code>.</p>
<p>As we can see, this difference is significant, and people have, <strong>in general</strong>, a lower <code>rt</code> (the sign is negative) in the speed condition.</p>
<p>Let’s visualize the <a href="https://easystats.github.io/modelbased/articles/estimate_means.html">marginal means</a> estimated by the model:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">estimate_means</span>(model_full) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">show_data =</span> <span class="st">&quot;violin&quot;</span>) </span></code></pre></div>
<p><img src="D:/Dropbox/RECHERCHE/N/easystats/modelbased/docs/articles/estimate_random_files/figure-html/unnamed-chunk-6-1.png" width="3281.25" /></p>
<p>Now, what’s up with the <strong>random effects</strong>. In the formula, we specified random intercepts (i.e., the right part of the bar <code>|</code> symbol) for <code>id</code> (the participants) and <code>stim</code>. That means that <strong>each participant and each stimulus will have its own “Intercept” parameter</strong> (which, as we’ve seen before, corresponds to the <code>rt</code> in the accuracy condition). Additionally, we’ve specified the random effect (“random slope” - the left side of the bar) of <code>condition</code> for each participant. That means that <strong>each participant will have its own effect of condition</strong> computed.</p>
<p>But do we need such a complex model? Let’s compare it to a model without specifying random intercepts for the stimuli.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rt <span class="sc">~</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">|</span> id), <span class="at">data =</span> data_rt)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">test_performance</span>(model_full, model)</span></code></pre></div>
<pre><code>&gt; Name       |   Model |      BF
&gt; ------------------------------
&gt; model_full | lmerMod |        
&gt; model      | lmerMod | &lt; 0.001
&gt; Models were detected as nested and are compared in sequential order.</code></pre>
<p>Mmmh, it seems that the simpler model performs <strong>a lot worse</strong> (the Bayes Factor is lower than 1). We could run <code>compare_performance()</code> to learn more details, but for this example we will go ahead and keep the <strong>worse model</strong> (for simplicity and conciseness when inspecting the random effects later, but keep in mind that in real life it’s surely not the best thing to do).</p>
</div>
<div id="group-level-effects" class="section level2">
<h2>Group-level Effects</h2>
<p>That’s nice to know, but how to actually <strong>get access</strong> to these group-level scores. We can use the <code>estimate_random()</code> function to retrieve them.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_random</span>(model)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>random</span></code></pre></div>
<pre><code>&gt; Group | Level |      Parameter | Coefficient |   SE |         95% CI
&gt; --------------------------------------------------------------------
&gt; id    |     1 |    (Intercept) |       -0.10 | 0.01 | [-0.12, -0.07]
&gt; id    |     1 | conditionspeed |        0.09 | 0.02 | [ 0.06,  0.12]
&gt; id    |     2 |    (Intercept) |        0.08 | 0.02 | [ 0.04,  0.12]
&gt; id    |     2 | conditionspeed |       -0.03 | 0.02 | [-0.07,  0.01]
&gt; id    |     3 |    (Intercept) |        0.02 | 0.01 | [ 0.00,  0.05]
&gt; id    |     3 | conditionspeed |       -0.02 | 0.02 | [-0.05,  0.01]
&gt; id    |     4 |    (Intercept) |       -0.13 | 0.01 | [-0.15, -0.10]
&gt; id    |     4 | conditionspeed |        0.08 | 0.02 | [ 0.05,  0.11]
&gt; id    |     5 |    (Intercept) |       -0.05 | 0.01 | [-0.08, -0.03]
&gt; id    |     5 | conditionspeed |    6.67e-03 | 0.02 | [-0.02,  0.04]
&gt; id    |     6 |    (Intercept) |       -0.08 | 0.01 | [-0.10, -0.05]
&gt; id    |     6 | conditionspeed |        0.04 | 0.02 | [ 0.01,  0.07]
&gt; id    |     7 |    (Intercept) |       -0.09 | 0.01 | [-0.12, -0.07]
&gt; id    |     7 | conditionspeed |        0.10 | 0.02 | [ 0.06,  0.13]
&gt; id    |     8 |    (Intercept) |        0.21 | 0.01 | [ 0.19,  0.24]
&gt; id    |     8 | conditionspeed |       -0.18 | 0.02 | [-0.21, -0.14]
&gt; id    |     9 |    (Intercept) |        0.03 | 0.01 | [ 0.00,  0.05]
&gt; id    |     9 | conditionspeed |       -0.02 | 0.02 | [-0.05,  0.01]
&gt; id    |    10 |    (Intercept) |       -0.10 | 0.01 | [-0.13, -0.08]
&gt; id    |    10 | conditionspeed |        0.07 | 0.02 | [ 0.04,  0.10]
&gt; id    |    11 |    (Intercept) |       -0.09 | 0.01 | [-0.11, -0.07]
&gt; id    |    11 | conditionspeed |        0.07 | 0.02 | [ 0.04,  0.11]
&gt; id    |    12 |    (Intercept) |   -6.47e-04 | 0.01 | [-0.03,  0.02]
&gt; id    |    12 | conditionspeed |    3.65e-03 | 0.02 | [-0.03,  0.04]
&gt; id    |    13 |    (Intercept) |        0.08 | 0.01 | [ 0.05,  0.10]
&gt; id    |    13 | conditionspeed |       -0.06 | 0.02 | [-0.09, -0.02]
&gt; id    |    14 |    (Intercept) |        0.03 | 0.01 | [ 0.01,  0.06]
&gt; id    |    14 | conditionspeed |       -0.03 | 0.02 | [-0.06,  0.00]
&gt; id    |    15 |    (Intercept) |        0.09 | 0.01 | [ 0.07,  0.11]
&gt; id    |    15 | conditionspeed |       -0.07 | 0.02 | [-0.10, -0.04]
&gt; id    |    16 |    (Intercept) |        0.04 | 0.01 | [ 0.02,  0.06]
&gt; id    |    16 | conditionspeed |       -0.01 | 0.02 | [-0.05,  0.02]
&gt; id    |    17 |    (Intercept) |        0.06 | 0.01 | [ 0.03,  0.08]
&gt; id    |    17 | conditionspeed |       -0.05 | 0.02 | [-0.08, -0.02]</code></pre>
<p>Each of our participant (the <strong>Level</strong> column), numbered from 1 to 17, has two rows, corresponding to its own deviation from the main effect of the <strong>intercept</strong> and <strong>condition effect</strong>.</p>
<p>We can also use <code>reshape_random()</code> to select only the <em>Coefficient</em> column (and skip the information about the uncertainty - which in real life is equally important!) and make it match the original data. The resulting table has the same length as the original dataset and can be merged with it: <strong>it’s a convenient way to re-incorporate the random effects into the data for further re-use</strong>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>reshaped <span class="ot">&lt;-</span> <span class="fu">reshape_random</span>(random, <span class="at">indices =</span> <span class="st">&quot;Coefficient&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(reshaped)</span></code></pre></div>
<pre><code>&gt;   id id_Coefficient_Intercept id_Coefficient_conditionspeed
&gt; 1  1                   -0.097                         0.094
&gt; 2  1                   -0.097                         0.094
&gt; 3  1                   -0.097                         0.094
&gt; 4  1                   -0.097                         0.094
&gt; 5  1                   -0.097                         0.094
&gt; 6  1                   -0.097                         0.094</code></pre>
<p>As you can see, the first row is repeated as it corresponds to the same participant (so the random effects are the same). Note that we can use <code>summary()</code> to remove all the duplicate rows. Let’s add it to the original data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(data_rt, reshaped, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p>We can also visualize the random effects:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(random) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  see<span class="sc">::</span><span class="fu">theme_lucid</span>()</span></code></pre></div>
<p><img src="D:/Dropbox/RECHERCHE/N/easystats/modelbased/docs/articles/estimate_random_files/figure-html/unnamed-chunk-11-1.png" width="3281.25" /></p>
<p>Wow! As we can see, there is a lot of between-participants variability. But what do these random parameters correspond to?</p>
</div>
<div id="correlation-with-empirical-scores" class="section level2">
<h2>Correlation with empirical scores</h2>
<p>We said above that the random effects are the group-level (the group unit is, in this model, the participants) version of the population-level effects (the fixed effects). One important thing to note is that they represent the <strong>deviation from the fixed effect</strong>, so a coefficient close to 0 means that the participants’ effect is the same as the population-level effect. In other words, he’s <strong>“in the norm”</strong> (note that we can also obtain the group-specific effect corresponding to the sum of the fixed and random by setting <code>estimate_random(model, deviation = FALSE)</code>).</p>
<p>Nevertheless, let’s compute some <strong>empirical scores</strong>, such as the condition averages for each participant.</p>
<p>We will group the data by participant and condition, get the mean RT, and then reshape the data so that we have, for each participant, the two means as two columns. Then, we will create a new dataframe (we will use the same - and overwrite it - to keep it concise), in which we will only keep the mean RT in the <strong>accuracy</strong> condition, and the difference with the <strong>speed</strong> condition <em>(reminds you of something?)</em>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_sub <span class="ot">&lt;-</span> data_rt <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id, condition) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rt =</span> <span class="fu">mean</span>(rt)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;condition&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;rt&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>data_sub <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> data_sub<span class="sc">$</span>id,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">empirical_accuracy =</span> data_sub<span class="sc">$</span>accuracy,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">empirical_condition =</span> data_sub<span class="sc">$</span>speed <span class="sc">-</span> data_sub<span class="sc">$</span>accuracy</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now, how to these <strong>empirical scores</strong> compare with the <strong>random effects</strong> estimated by the model? Let’s merge the empirical scores with the random effects scores. For that, we will run <code>summary()</code> on the <strong>reshaped</strong> random effects to remove all the duplicate rows (and have only one row per participant, so that it matches the format of <code>data_sub</code>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_sub <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(data_sub, <span class="fu">summary</span>(reshaped), <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p>Let’s run a correlation between the model-based scores and the empirical scores.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>correlation<span class="sc">::</span><span class="fu">correlation</span>(data_sub)</span></code></pre></div>
<pre><code>&gt; # Correlation Matrix (pearson-method)
&gt; 
&gt; Parameter1               |                    Parameter2 |     r |         95% CI |  t(15) |         p
&gt; ------------------------------------------------------------------------------------------------------
&gt; empirical_accuracy       |           empirical_condition | -0.94 | [-0.98, -0.84] | -10.72 | &lt; .001***
&gt; empirical_accuracy       |      id_Coefficient_Intercept |  1.00 | [ 1.00,  1.00] | 198.45 | &lt; .001***
&gt; empirical_accuracy       | id_Coefficient_conditionspeed | -0.98 | [-0.99, -0.93] | -17.37 | &lt; .001***
&gt; empirical_condition      |      id_Coefficient_Intercept | -0.93 | [-0.98, -0.82] | -10.10 | &lt; .001***
&gt; empirical_condition      | id_Coefficient_conditionspeed |  0.99 | [ 0.98,  1.00] |  29.16 | &lt; .001***
&gt; id_Coefficient_Intercept | id_Coefficient_conditionspeed | -0.97 | [-0.99, -0.92] | -15.95 | &lt; .001***
&gt; 
&gt; p-value adjustment method: Holm (1979)
&gt; Observations: 17</code></pre>
<p>First thing to notice is that <strong>everything is significantly and strongly correlated</strong>!.</p>
<p>Then, the empirical scores for accuracy and condition, corresponding to the “raw” average of RT, correlate <strong>almost perfectly with their model-based counterpart</strong> (<span class="math inline">\(r_{empirical\_accuracy/Coefficient\_Intercept} = 1\)</span>; <span class="math inline">\(r_{empirical\_condition/Coefficient\_conditionspeed} &gt; .99\)</span>). That’s reassuring, it means that our model has managed to estimate some intuitive parameters!</p>
<p>Finally, we can observe that there is a strong and negative correlation (which is even more salient with model-based indices) between the RT in the accuracy condition and the effect of the speed condition:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_sub, <span class="fu">aes</span>(<span class="at">x =</span> id_Coefficient_Intercept, <span class="at">y =</span> id_Coefficient_conditionspeed)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  see<span class="sc">::</span><span class="fu">theme_modern</span>()</span></code></pre></div>
<p><img src="D:/Dropbox/RECHERCHE/N/easystats/modelbased/docs/articles/estimate_random_files/figure-html/unnamed-chunk-15-1.png" width="3281.25" /></p>
<p>The slower they are in the accuracy condition, the bigger the difference with the speed condition.</p>
</div>
</div>
<div id="accuracy" class="section level1">
<h1>Accuracy</h1>
<p>In this section, we will take interest in the accuracy - the probability of making errors, using <strong>logistic models</strong>.</p>
</div>
<div id="correlations-between-speed-and-accuracy" class="section level1">
<h1>Correlations between speed and accuracy</h1>
</div>
<div id="log-shifted-model" class="section level1">
<h1>Log-shifted Model</h1>
</div>
<div id="scale-location-model" class="section level1">
<h1>Scale-Location Model</h1>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc">
      <h2 data-toc-skip>Contents</h2>
    </nav>
      </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://dominiquemakowski.github.io/'>Dominique Makowski</a>, <a href='https://github.com/strengejacke'>Daniel Lüdecke</a>, <a href='https://github.com/mattansb'>Mattan S. Ben-Shachar</a>, <a href='https://sites.google.com/site/indrajeetspatilmorality/'>Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>

